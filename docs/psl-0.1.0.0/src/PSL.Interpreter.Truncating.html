<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PSL.Interpreter.Truncating</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">UVMHS</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><a href="PSL.Syntax.html"><span class="hs-identifier">PSL.Syntax</span></a><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-identifier">trNat</span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span>
</span><a name="line-8"></a><a name="trNat"><a href="PSL.Interpreter.Truncating.html#trNat"><span class="hs-identifier">trNat</span></a></a><span> </span><a name="local-6989586621679297139"><a href="#local-6989586621679297139"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679297140"><a href="#local-6989586621679297140"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679297140"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&#247;</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">^^</span><span> </span><a href="#local-6989586621679297139"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-identifier">trPrNat</span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><a href="PSL.Syntax.html#IPrecision"><span class="hs-identifier hs-type">IPrecision</span></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span>
</span><a name="line-11"></a><a name="trPrNat"><a href="PSL.Interpreter.Truncating.html#trPrNat"><span class="hs-identifier">trPrNat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-12"></a><span>  </span><a href="PSL.Syntax.html#InfIPr"><span class="hs-identifier hs-var">InfIPr</span></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-13"></a><span>  </span><a href="PSL.Syntax.html#FixedIPr"><span class="hs-identifier hs-var">FixedIPr</span></a><span> </span><a name="local-6989586621679297141"><a href="#local-6989586621679297141"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679297142"><a href="#local-6989586621679297142"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><a href="PSL.Interpreter.Truncating.html#trNat"><span class="hs-identifier hs-var">trNat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679297141"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679297142"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-identifier">buNat</span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span>
</span><a name="line-16"></a><a name="buNat"><a href="PSL.Interpreter.Truncating.html#buNat"><span class="hs-identifier">buNat</span></a></a><span> </span><a name="local-6989586621679297143"><a href="#local-6989586621679297143"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679297144"><a href="#local-6989586621679297144"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679297144"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">^^</span><span> </span><a href="#local-6989586621679297143"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-identifier">buPrNat</span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><a href="PSL.Syntax.html#IPrecision"><span class="hs-identifier hs-type">IPrecision</span></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span>
</span><a name="line-19"></a><a name="buPrNat"><a href="PSL.Interpreter.Truncating.html#buPrNat"><span class="hs-identifier">buPrNat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-20"></a><span>  </span><a href="PSL.Syntax.html#InfIPr"><span class="hs-identifier hs-var">InfIPr</span></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-21"></a><span>  </span><a href="PSL.Syntax.html#FixedIPr"><span class="hs-identifier hs-var">FixedIPr</span></a><span> </span><a name="local-6989586621679297145"><a href="#local-6989586621679297145"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679297146"><a href="#local-6989586621679297146"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><a href="PSL.Interpreter.Truncating.html#buNat"><span class="hs-identifier hs-var">buNat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679297145"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679297146"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-identifier">trInt</span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#8484;</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#8484;</span><span>
</span><a name="line-24"></a><a name="trInt"><a href="PSL.Interpreter.Truncating.html#trInt"><span class="hs-identifier">trInt</span></a></a><span> </span><a name="local-6989586621679297147"><a href="#local-6989586621679297147"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679297148"><a href="#local-6989586621679297148"><span class="hs-identifier">i</span></a></a><span>
</span><a name="line-25"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679297148"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-identifier hs-var">neg</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">int</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">^^</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679297147"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PSL.Interpreter.Truncating.html#trInt"><span class="hs-identifier hs-var">trInt</span></a><span> </span><a href="#local-6989586621679297147"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679297148"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">int</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">^^</span><span> </span><a href="#local-6989586621679297147"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679297148"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-identifier hs-var">int</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">^^</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679297147"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PSL.Interpreter.Truncating.html#trInt"><span class="hs-identifier hs-var">trInt</span></a><span> </span><a href="#local-6989586621679297147"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679297148"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">int</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">^^</span><span> </span><a href="#local-6989586621679297147"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679297148"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-identifier">trPrInt</span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><a href="PSL.Syntax.html#IPrecision"><span class="hs-identifier hs-type">IPrecision</span></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#8484;</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#8484;</span><span>
</span><a name="line-30"></a><a name="trPrInt"><a href="PSL.Interpreter.Truncating.html#trPrInt"><span class="hs-identifier">trPrInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-31"></a><span>  </span><a href="PSL.Syntax.html#InfIPr"><span class="hs-identifier hs-var">InfIPr</span></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-32"></a><span>  </span><a href="PSL.Syntax.html#FixedIPr"><span class="hs-identifier hs-var">FixedIPr</span></a><span> </span><a name="local-6989586621679297149"><a href="#local-6989586621679297149"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679297150"><a href="#local-6989586621679297150"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><a href="PSL.Interpreter.Truncating.html#trInt"><span class="hs-identifier hs-var">trInt</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679297149"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679297150"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-33"></a></pre></body></html>