<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PSL.Syntax</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">UVMHS</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- import AddToUVMHS</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-comment">----------</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Kind --</span><span>
</span><a name="line-8"></a><span class="hs-comment">----------</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-comment">-- &#954; &#8712; kind &#10868;  &#8230;</span><span>
</span><a name="line-11"></a><span class="hs-keyword">data</span><span> </span><a name="Kind"><a href="PSL.Syntax.html#Kind"><span class="hs-identifier">Kind</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-12"></a><span>    </span><a name="TypeK"><a href="PSL.Syntax.html#TypeK"><span class="hs-identifier">TypeK</span></a></a><span>  </span><span class="hs-comment">-- &#9734;   /  type</span><span>
</span><a name="line-13"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PrinK"><a href="PSL.Syntax.html#PrinK"><span class="hs-identifier">PrinK</span></a></a><span>  </span><span class="hs-comment">-- &#8473;   /  prin</span><span>
</span><a name="line-14"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PrinsK"><a href="PSL.Syntax.html#PrinsK"><span class="hs-identifier">PrinsK</span></a></a><span> </span><span class="hs-comment">-- &#8473;s  /  prins</span><span>
</span><a name="line-15"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span class="hs-identifier hs-var">makePrettySum</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Kind</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-comment">----------</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- Prin --</span><span>
</span><a name="line-20"></a><span class="hs-comment">----------</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-comment">-- &#961; &#8712; prin &#8776; &#120138;</span><span>
</span><a name="line-23"></a><span class="hs-keyword">type</span><span> </span><a name="Prin"><a href="PSL.Syntax.html#Prin"><span class="hs-identifier">Prin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">&#120138;</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">data</span><span> </span><a name="PrinVal"><a href="PSL.Syntax.html#PrinVal"><span class="hs-identifier">PrinVal</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-26"></a><span>    </span><a name="SinglePV"><a href="PSL.Syntax.html#SinglePV"><span class="hs-identifier">SinglePV</span></a></a><span> </span><a href="PSL.Syntax.html#Prin"><span class="hs-identifier hs-type">Prin</span></a><span>
</span><a name="line-27"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AccessPV"><a href="PSL.Syntax.html#AccessPV"><span class="hs-identifier">AccessPV</span></a></a><span> </span><a href="PSL.Syntax.html#Prin"><span class="hs-identifier hs-type">Prin</span></a><span> </span><span class="hs-identifier hs-type">&#8469;</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="VirtualPV"><a href="PSL.Syntax.html#VirtualPV"><span class="hs-identifier">VirtualPV</span></a></a><span> </span><a href="PSL.Syntax.html#Prin"><span class="hs-identifier hs-type">Prin</span></a><span>
</span><a name="line-29"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">data</span><span> </span><a name="PrinExpVal"><a href="PSL.Syntax.html#PrinExpVal"><span class="hs-identifier">PrinExpVal</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-32"></a><span>    </span><a name="ValPEV"><a href="PSL.Syntax.html#ValPEV"><span class="hs-identifier">ValPEV</span></a></a><span> </span><a href="PSL.Syntax.html#PrinVal"><span class="hs-identifier hs-type">PrinVal</span></a><span>
</span><a name="line-33"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PowPEV"><a href="PSL.Syntax.html#PowPEV"><span class="hs-identifier">PowPEV</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119875;</span><span> </span><a href="PSL.Syntax.html#PrinVal"><span class="hs-identifier hs-type">PrinVal</span></a><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SetPEV"><a href="PSL.Syntax.html#SetPEV"><span class="hs-identifier">SetPEV</span></a></a><span> </span><span class="hs-identifier hs-type">&#8469;</span><span> </span><a href="PSL.Syntax.html#Prin"><span class="hs-identifier hs-type">Prin</span></a><span>
</span><a name="line-35"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">data</span><span> </span><a name="PrinExp"><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier">PrinExp</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-38"></a><span>    </span><a name="VarPE"><a href="PSL.Syntax.html#VarPE"><span class="hs-identifier">VarPE</span></a></a><span> </span><span class="hs-identifier hs-type">&#120143;</span><span>
</span><a name="line-39"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AccessPE"><a href="PSL.Syntax.html#AccessPE"><span class="hs-identifier">AccessPE</span></a></a><span> </span><span class="hs-identifier hs-type">&#120143;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="StarPE"><a href="PSL.Syntax.html#StarPE"><span class="hs-identifier">StarPE</span></a></a><span> </span><span class="hs-identifier hs-type">&#120143;</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ThisPE"><a href="PSL.Syntax.html#ThisPE"><span class="hs-identifier">ThisPE</span></a></a><span>
</span><a name="line-42"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span class="hs-identifier hs-var">makePrettySum</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">PrinExp</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-keyword">data</span><span> </span><a name="PrinDecl"><a href="PSL.Syntax.html#PrinDecl"><span class="hs-identifier">PrinDecl</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-46"></a><span>    </span><a name="SinglePD"><a href="PSL.Syntax.html#SinglePD"><span class="hs-identifier">SinglePD</span></a></a><span> </span><a href="PSL.Syntax.html#Prin"><span class="hs-identifier hs-type">Prin</span></a><span>
</span><a name="line-47"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ArrayPD"><a href="PSL.Syntax.html#ArrayPD"><span class="hs-identifier">ArrayPD</span></a></a><span> </span><a href="PSL.Syntax.html#Prin"><span class="hs-identifier hs-type">Prin</span></a><span> </span><span class="hs-identifier hs-type">&#8469;</span><span>
</span><a name="line-48"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span class="hs-identifier hs-var">makePrettySum</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">PrinDecl</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-keyword">data</span><span> </span><a name="PrinKind"><a href="PSL.Syntax.html#PrinKind"><span class="hs-identifier">PrinKind</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-52"></a><span>    </span><a name="SinglePK"><a href="PSL.Syntax.html#SinglePK"><span class="hs-identifier">SinglePK</span></a></a><span>
</span><a name="line-53"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SetPK"><a href="PSL.Syntax.html#SetPK"><span class="hs-identifier">SetPK</span></a></a><span> </span><span class="hs-identifier hs-type">&#8469;</span><span>
</span><a name="line-54"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="VirtualPK"><a href="PSL.Syntax.html#VirtualPK"><span class="hs-identifier">VirtualPK</span></a></a><span>
</span><a name="line-55"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span class="hs-identifier hs-var">makePrettySum</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">PrinKind</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-comment">----------------</span><span>
</span><a name="line-59"></a><span class="hs-comment">-- Constraint --</span><span>
</span><a name="line-60"></a><span class="hs-comment">----------------</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- C &#8712; constraint &#10868;  &#8230;</span><span>
</span><a name="line-63"></a><span class="hs-keyword">data</span><span> </span><a name="Constr"><a href="PSL.Syntax.html#Constr"><span class="hs-identifier">Constr</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-64"></a><span>    </span><a name="SubsetC"><a href="PSL.Syntax.html#SubsetC"><span class="hs-identifier">SubsetC</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">--  P &#8838; P  /  P c= P</span><span>
</span><a name="line-65"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span class="hs-identifier hs-var">makePrettySum</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Constr</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-comment">----------</span><span>
</span><a name="line-69"></a><span class="hs-comment">-- Mode --</span><span>
</span><a name="line-70"></a><span class="hs-comment">----------</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-keyword">data</span><span> </span><a name="Mode"><a href="PSL.Syntax.html#Mode"><span class="hs-identifier">Mode</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-73"></a><span>    </span><a name="SecM"><a href="PSL.Syntax.html#SecM"><span class="hs-identifier">SecM</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119875;</span><span> </span><a href="PSL.Syntax.html#PrinVal"><span class="hs-identifier hs-type">PrinVal</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TopM"><a href="PSL.Syntax.html#TopM"><span class="hs-identifier">TopM</span></a></a><span>
</span><a name="line-75"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span class="hs-identifier hs-var">makePrisms</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Mode</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">POrd</span><span> </span><a href="PSL.Syntax.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-79"></a><span>  </span><span class="hs-identifier">_</span><span> </span><a name="local-8214565720323803373"><span class="hs-operator">&#8849;</span></a><span> </span><a href="PSL.Syntax.html#TopM"><span class="hs-identifier hs-var">TopM</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-80"></a><span>  </span><span class="hs-comment">-- SecM &#961;&#8321; &#8849; SecM &#961;&#8322; | &#961;&#8321; &#8801; &#961;&#8322; = True</span><span>
</span><a name="line-81"></a><span>  </span><span class="hs-comment">-- SecM &#961;&#8321; &#8849; PSecM &#961;s&#8322; | &#961;&#8321; &#8712; &#961;s&#8322; = True</span><span>
</span><a name="line-82"></a><span>  </span><span class="hs-comment">-- PSecM &#961;s&#8321; &#8849; SecM &#961;&#8321; | &#961;s&#8321; &#8801; single &#961;&#8321; = True</span><span>
</span><a name="line-83"></a><span>  </span><a href="PSL.Syntax.html#SecM"><span class="hs-identifier hs-var">SecM</span></a><span> </span><a name="local-6989586621679073748"><a href="#local-6989586621679073748"><span class="hs-identifier">&#961;s&#8321;</span></a></a><span> </span><span class="hs-operator">&#8849;</span><span> </span><a href="PSL.Syntax.html#SecM"><span class="hs-identifier hs-var">SecM</span></a><span> </span><a name="local-6989586621679073749"><a href="#local-6989586621679073749"><span class="hs-identifier">&#961;s&#8322;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679073748"><span class="hs-identifier hs-var">&#961;s&#8321;</span></a><span> </span><span class="hs-operator hs-var">&#8838;</span><span> </span><a href="#local-6989586621679073749"><span class="hs-identifier hs-var">&#961;s&#8322;</span></a><span>
</span><a name="line-84"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">&#8849;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-----------------</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- Effect Mode --</span><span>
</span><a name="line-88"></a><span class="hs-comment">-----------------</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-keyword">data</span><span> </span><a name="EMode"><a href="PSL.Syntax.html#EMode"><span class="hs-identifier">EMode</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-91"></a><span>    </span><a name="SecEM"><a href="PSL.Syntax.html#SecEM"><span class="hs-identifier">SecEM</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- (&#119875; PrinVal)</span><span>
</span><a name="line-92"></a><span>  </span><span class="hs-comment">-- | SSecEM (&#119871; PrinExp) -- (&#119875; PrinVal)</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TopEM"><a href="PSL.Syntax.html#TopEM"><span class="hs-identifier">TopEM</span></a></a><span>
</span><a name="line-94"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span class="hs-identifier hs-var">makePrettySum</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">EMode</span><span>
</span><a name="line-96"></a><span class="hs-identifier hs-var">makePrisms</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">EMode</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">-- instance Top EMode where top = TopEM</span><span>
</span><a name="line-99"></a><span class="hs-comment">-- instance Join EMode where</span><span>
</span><a name="line-100"></a><span class="hs-comment">--   PSecEM &#961;s&#8321; &#8852; PSecEM &#961;s&#8322; = PSecEM $ &#961;s&#8321; &#10746; &#961;s&#8322;</span><span>
</span><a name="line-101"></a><span class="hs-comment">--   PSecEM &#961;s&#8321; &#8852; SSecEM &#961;s&#8322; = PSecEM $ &#961;s&#8321; &#10746; &#961;s&#8322;</span><span>
</span><a name="line-102"></a><span class="hs-comment">--   SSecEM &#961;s&#8321; &#8852; PSecEM &#961;s&#8322; = PSecEM $ &#961;s&#8321; &#10746; &#961;s&#8322;</span><span>
</span><a name="line-103"></a><span class="hs-comment">--   SSecEM &#961;s&#8321; &#8852; SSecEM &#961;s&#8322; = SSecEM $ &#961;s&#8321; &#10746; &#961;s&#8322;</span><span>
</span><a name="line-104"></a><span class="hs-comment">--   _ &#8852; _ = TopEM</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">------------</span><span>
</span><a name="line-107"></a><span class="hs-comment">-- Effect --</span><span>
</span><a name="line-108"></a><span class="hs-comment">------------</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-comment">-- &#951; &#8712; effect &#10868;  &#8230;</span><span>
</span><a name="line-111"></a><span class="hs-keyword">data</span><span> </span><a name="Effect"><a href="PSL.Syntax.html#Effect"><span class="hs-identifier">Effect</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Effect"><a href="PSL.Syntax.html#Effect"><span class="hs-identifier">Effect</span></a></a><span>
</span><a name="line-112"></a><span>  </span><span class="hs-comment">--  inp:P,rev:P</span><span>
</span><a name="line-113"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="effectInput"><a href="PSL.Syntax.html#effectInput"><span class="hs-identifier">effectInput</span></a></a><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-identifier hs-type">&#119875;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span>
</span><a name="line-114"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="effectReveal"><a href="PSL.Syntax.html#effectReveal"><span class="hs-identifier">effectReveal</span></a></a><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-identifier hs-type">&#119875;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span>
</span><a name="line-115"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="effectMode"><a href="PSL.Syntax.html#effectMode"><span class="hs-identifier">effectMode</span></a></a><span> </span><span class="hs-glyph">&#8759;</span><span> </span><a href="PSL.Syntax.html#EMode"><span class="hs-identifier hs-type">EMode</span></a><span>
</span><a name="line-116"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span class="hs-identifier hs-var">makePrettySum</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Effect</span><span>
</span><a name="line-118"></a><span class="hs-identifier hs-var">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Effect</span><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span class="hs-comment">-- instance Null Effect where null = Effect p&#248; p&#248; TopEM</span><span>
</span><a name="line-121"></a><span class="hs-comment">-- instance Append Effect where</span><span>
</span><a name="line-122"></a><span class="hs-comment">--   Effect ei&#8321; er&#8321; em&#8321; &#10746; Effect ei&#8322; er&#8322; em&#8322; = Effect (ei&#8321; &#8746; ei&#8322;) (er&#8321; &#8746; er&#8322;) $ em&#8321; &#8852; em&#8322;</span><span>
</span><a name="line-123"></a><span class="hs-comment">-- instance Monoid Effect</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">-- instance POrd Effect where</span><span>
</span><a name="line-126"></a><span class="hs-comment">--   Effect ei&#8321; er&#8321; em&#8321; &#8849; Effect ei&#8322; er&#8322; em&#8322; = (ei&#8321; &#8838; ei&#8322;) &#10835; (er&#8321; &#8838; er&#8322;) &#10835; (em&#8321; &#8849; em&#8322;)</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-comment">----------</span><span>
</span><a name="line-129"></a><span class="hs-comment">-- TVar --</span><span>
</span><a name="line-130"></a><span class="hs-comment">----------</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-keyword">type</span><span> </span><a name="TVar"><a href="PSL.Syntax.html#TVar"><span class="hs-identifier">TVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">&#120143;</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-comment">----------</span><span>
</span><a name="line-135"></a><span class="hs-comment">-- Prot --</span><span>
</span><a name="line-136"></a><span class="hs-comment">----------</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-comment">-- &#966; &#8712; protocol &#10868;  &#8230;</span><span>
</span><a name="line-139"></a><span class="hs-keyword">data</span><span> </span><a name="Prot"><a href="PSL.Syntax.html#Prot"><span class="hs-identifier">Prot</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-140"></a><span>    </span><a name="YaoP"><a href="PSL.Syntax.html#YaoP"><span class="hs-identifier">YaoP</span></a></a><span>  </span><span class="hs-comment">-- yao</span><span>
</span><a name="line-141"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BGWP"><a href="PSL.Syntax.html#BGWP"><span class="hs-identifier">BGWP</span></a></a><span>  </span><span class="hs-comment">-- bgw</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="GMWP"><a href="PSL.Syntax.html#GMWP"><span class="hs-identifier">GMWP</span></a></a><span>  </span><span class="hs-comment">-- gmw</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BGVP"><a href="PSL.Syntax.html#BGVP"><span class="hs-identifier">BGVP</span></a></a><span>  </span><span class="hs-comment">-- bgv</span><span>
</span><a name="line-144"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SPDZP"><a href="PSL.Syntax.html#SPDZP"><span class="hs-identifier">SPDZP</span></a></a><span> </span><span class="hs-comment">-- spdz</span><span>
</span><a name="line-145"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AutoP"><a href="PSL.Syntax.html#AutoP"><span class="hs-identifier">AutoP</span></a></a><span> </span><span class="hs-comment">-- auto</span><span>
</span><a name="line-146"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-149"></a><span class="hs-comment">-- Precision --</span><span>
</span><a name="line-150"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-keyword">data</span><span> </span><a name="IPrecision"><a href="PSL.Syntax.html#IPrecision"><span class="hs-identifier">IPrecision</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-153"></a><span>    </span><a name="InfIPr"><a href="PSL.Syntax.html#InfIPr"><span class="hs-identifier">InfIPr</span></a></a><span>
</span><a name="line-154"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FixedIPr"><a href="PSL.Syntax.html#FixedIPr"><span class="hs-identifier">FixedIPr</span></a></a><span> </span><span class="hs-identifier hs-type">&#8469;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span> </span><span class="hs-comment">-- whole number precision, and decimal precision</span><span>
</span><a name="line-155"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-identifier">iprDefault</span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><a href="PSL.Syntax.html#IPrecision"><span class="hs-identifier hs-type">IPrecision</span></a><span>
</span><a name="line-158"></a><a name="iprDefault"><a href="PSL.Syntax.html#iprDefault"><span class="hs-identifier">iprDefault</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PSL.Syntax.html#FixedIPr"><span class="hs-identifier hs-var">FixedIPr</span></a><span> </span><span class="hs-number">64</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-keyword">data</span><span> </span><a name="FPrecision"><a href="PSL.Syntax.html#FPrecision"><span class="hs-identifier">FPrecision</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-161"></a><span>    </span><a name="FixedFPr"><a href="PSL.Syntax.html#FixedFPr"><span class="hs-identifier">FixedFPr</span></a></a><span> </span><span class="hs-identifier hs-type">&#8469;</span><span> </span><span class="hs-identifier hs-type">&#8469;</span><span>
</span><a name="line-162"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-identifier">fprDefault</span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><a href="PSL.Syntax.html#FPrecision"><span class="hs-identifier hs-type">FPrecision</span></a><span>
</span><a name="line-165"></a><a name="fprDefault"><a href="PSL.Syntax.html#fprDefault"><span class="hs-identifier">fprDefault</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PSL.Syntax.html#FixedFPr"><span class="hs-identifier hs-var">FixedFPr</span></a><span> </span><span class="hs-number">11</span><span> </span><span class="hs-number">53</span><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">----------</span><span>
</span><a name="line-168"></a><span class="hs-comment">-- Type --</span><span>
</span><a name="line-169"></a><span class="hs-comment">----------</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-comment">-- &#964; &#8712; type &#10868;  &#8230;</span><span>
</span><a name="line-172"></a><span class="hs-keyword">data</span><span> </span><a name="Type"><a href="PSL.Syntax.html#Type"><span class="hs-identifier">Type</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-173"></a><span>    </span><a name="VarT"><a href="PSL.Syntax.html#VarT"><span class="hs-identifier">VarT</span></a></a><span> </span><a href="PSL.Syntax.html#TVar"><span class="hs-identifier hs-type">TVar</span></a><span>                                   </span><span class="hs-comment">--  &#945;                          /  &#945;</span><span>
</span><a name="line-174"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="UnitT"><a href="PSL.Syntax.html#UnitT"><span class="hs-identifier">UnitT</span></a></a><span>                                       </span><span class="hs-comment">--  &#120793;                          /  unit</span><span>
</span><a name="line-175"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="%1D539T"><a href="PSL.Syntax.html#%1D539T"><span class="hs-identifier">&#120121;T</span></a></a><span>                                          </span><span class="hs-comment">--  &#120121;                          /  bool</span><span>
</span><a name="line-176"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="%1D54AT"><a href="PSL.Syntax.html#%1D54AT"><span class="hs-identifier">&#120138;T</span></a></a><span>                                          </span><span class="hs-comment">--  &#120138;                          /  string</span><span>
</span><a name="line-177"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="%2119T"><a href="PSL.Syntax.html#%2119T"><span class="hs-identifier">&#8473;T</span></a></a><span>                                          </span><span class="hs-comment">--  &#8473;                          /  prin</span><span>
</span><a name="line-178"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="%2119sT"><a href="PSL.Syntax.html#%2119sT"><span class="hs-identifier">&#8473;sT</span></a></a><span>                                         </span><span class="hs-comment">--  &#8473;s                         /  prins</span><span>
</span><a name="line-179"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="%2115T"><a href="PSL.Syntax.html#%2115T"><span class="hs-identifier">&#8469;T</span></a></a><span> </span><a href="PSL.Syntax.html#IPrecision"><span class="hs-identifier hs-type">IPrecision</span></a><span>                               </span><span class="hs-comment">--  &#8469;#n.n                      /  nat#n.n</span><span>
</span><a name="line-180"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="%2124T"><a href="PSL.Syntax.html#%2124T"><span class="hs-identifier">&#8484;T</span></a></a><span> </span><a href="PSL.Syntax.html#IPrecision"><span class="hs-identifier hs-type">IPrecision</span></a><span>                               </span><span class="hs-comment">--  &#8484;#n.n                      /  int#n.n</span><span>
</span><a name="line-181"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="%1D53DT"><a href="PSL.Syntax.html#%1D53DT"><span class="hs-identifier">&#120125;T</span></a></a><span> </span><a href="PSL.Syntax.html#FPrecision"><span class="hs-identifier hs-type">FPrecision</span></a><span>                               </span><span class="hs-comment">--  &#120125;#n                        /  float#n</span><span>
</span><a name="line-182"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a name="%3A%2B%3A"><a href="PSL.Syntax.html#%3A%2B%3A"><span class="hs-operator">:+:</span></a></a><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                               </span><span class="hs-comment">--  &#964; + &#964;                      /  &#964; + &#964;</span><span>
</span><a name="line-183"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a name="%3A%D7%3A"><a href="PSL.Syntax.html#%3A%D7%3A"><span class="hs-operator">:&#215;:</span></a></a><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                               </span><span class="hs-comment">--  &#964; &#215; &#964;                      /  &#964; * &#964;</span><span>
</span><a name="line-184"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ListT"><a href="PSL.Syntax.html#ListT"><span class="hs-identifier">ListT</span></a></a><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                                  </span><span class="hs-comment">--  list &#964;                     /  list &#964;</span><span>
</span><a name="line-185"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RefT"><a href="PSL.Syntax.html#RefT"><span class="hs-identifier">RefT</span></a></a><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                                   </span><span class="hs-comment">--  ref &#964;                      /  ref &#964;</span><span>
</span><a name="line-186"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ArrT"><a href="PSL.Syntax.html#ArrT"><span class="hs-identifier">ArrT</span></a></a><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                                   </span><span class="hs-comment">--  arr &#964;                      /  arr &#964;</span><span>
</span><a name="line-187"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a name="%3A%2192%3A"><a href="PSL.Syntax.html#%3A%2192%3A"><span class="hs-operator">:&#8594;:</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Effect</span><span> </span><span class="hs-operator hs-type">&#8743;</span><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>                    </span><span class="hs-comment">--  &#964; &#8594;{&#951;} &#964;                   /  &#964; -&gt;{&#951;} &#964;</span><span>
</span><a name="line-188"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#120143;</span><span> </span><span class="hs-operator hs-type">&#8743;</span><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-operator">&#8743;</span><span> </span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#Constr"><span class="hs-identifier hs-type">Constr</span></a><span class="hs-special">)</span><span> </span><a name="%3A%2192%2020%3A"><a href="PSL.Syntax.html#%3A%2192%2020%3A"><span class="hs-operator">:&#8594;&#8224;:</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Effect</span><span> </span><span class="hs-operator hs-type">&#8743;</span><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">--  (x : &#964; | c,&#8230;,c) &#8594;{&#951;} &#964;     /  (x : &#964; | c,&#8230;,c) -&gt;{&#951;} &#964;</span><span>
</span><a name="line-189"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ForallT"><a href="PSL.Syntax.html#ForallT"><span class="hs-identifier">ForallT</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TVar</span><span> </span><span class="hs-operator hs-type">&#8743;</span><span> </span><a href="PSL.Syntax.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#Constr"><span class="hs-identifier hs-type">Constr</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>   </span><span class="hs-comment">--  &#8704; &#945;:&#954;,&#8230;,&#945;:&#954; | c,&#8230;,c. &#964;     /  forall &#945;:&#954;,&#8230;,&#945;:&#954; | c,&#8230;,c. &#964;</span><span>
</span><a name="line-190"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SecT"><a href="PSL.Syntax.html#SecT"><span class="hs-identifier">SecT</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                       </span><span class="hs-comment">--  &#964;{P}                       /  &#964;{P}</span><span>
</span><a name="line-191"></a><span>  </span><span class="hs-comment">-- | SSecT (&#119871; PrinExp) Type                      --  &#964;{ssec:P}                  /  &#964;{ssec:P}</span><span>
</span><a name="line-192"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ISecT"><a href="PSL.Syntax.html#ISecT"><span class="hs-identifier">ISecT</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                      </span><span class="hs-comment">--  &#964;{bundle:P}                /  &#964;{bundle:P}</span><span>
</span><a name="line-193"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ShareT"><a href="PSL.Syntax.html#ShareT"><span class="hs-identifier">ShareT</span></a></a><span> </span><a href="PSL.Syntax.html#Prot"><span class="hs-identifier hs-type">Prot</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                </span><span class="hs-comment">--  &#964;{&#966;:P}                     /  &#964;{&#966;:P}</span><span>
</span><a name="line-194"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NizkTestT"><a href="PSL.Syntax.html#NizkTestT"><span class="hs-identifier">NizkTestT</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                  </span><span class="hs-comment">--  nizk-test{P} &#964;             /  nizk-test{P} &#964;</span><span>
</span><a name="line-195"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NizkVerifyT"><a href="PSL.Syntax.html#NizkVerifyT"><span class="hs-identifier">NizkVerifyT</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                </span><span class="hs-comment">--  nizk-verify{P} &#964;           /  nizk-verify{P} &#964;</span><span>
</span><a name="line-196"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span class="hs-identifier hs-var">makePrettySum</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Type</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-comment">---------</span><span>
</span><a name="line-200"></a><span class="hs-comment">-- Var --</span><span>
</span><a name="line-201"></a><span class="hs-comment">---------</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-keyword">type</span><span> </span><a name="Var"><a href="PSL.Syntax.html#Var"><span class="hs-identifier">Var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">&#120143;</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-206"></a><span class="hs-comment">-- Pattern --</span><span>
</span><a name="line-207"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">-- &#968; &#8712; pat &#10868;  &#8230;</span><span>
</span><a name="line-210"></a><span class="hs-keyword">data</span><span> </span><a name="Pat"><a href="PSL.Syntax.html#Pat"><span class="hs-identifier">Pat</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-211"></a><span>    </span><a name="VarP"><a href="PSL.Syntax.html#VarP"><span class="hs-identifier">VarP</span></a></a><span> </span><a href="PSL.Syntax.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>              </span><span class="hs-comment">-- x        /  x</span><span>
</span><a name="line-212"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BulP"><a href="PSL.Syntax.html#BulP"><span class="hs-identifier">BulP</span></a></a><span>                  </span><span class="hs-comment">-- &#8226;        /  ()</span><span>
</span><a name="line-213"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LP"><a href="PSL.Syntax.html#LP"><span class="hs-identifier">LP</span></a></a><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span>                </span><span class="hs-comment">-- L &#968;      /  L &#968;</span><span>
</span><a name="line-214"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RP"><a href="PSL.Syntax.html#RP"><span class="hs-identifier">RP</span></a></a><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span>                </span><span class="hs-comment">-- R &#968;      /  R &#968;</span><span>
</span><a name="line-215"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TupP"><a href="PSL.Syntax.html#TupP"><span class="hs-identifier">TupP</span></a></a><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span>          </span><span class="hs-comment">-- &#968;,&#968;      /  &#968;,&#968;</span><span>
</span><a name="line-216"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NilP"><a href="PSL.Syntax.html#NilP"><span class="hs-identifier">NilP</span></a></a><span>                  </span><span class="hs-comment">-- []       /  []</span><span>
</span><a name="line-217"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ConsP"><a href="PSL.Syntax.html#ConsP"><span class="hs-identifier">ConsP</span></a></a><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span>         </span><span class="hs-comment">-- &#968;&#8759;&#968;      /  &#968;::&#968;</span><span>
</span><a name="line-218"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EmptyP"><a href="PSL.Syntax.html#EmptyP"><span class="hs-identifier">EmptyP</span></a></a><span>                </span><span class="hs-comment">-- &#10218;&#10219;       /  &lt;&lt;&gt;&gt;</span><span>
</span><a name="line-219"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BundleP"><a href="PSL.Syntax.html#BundleP"><span class="hs-identifier">BundleP</span></a></a><span> </span><span class="hs-identifier hs-type">&#120143;</span><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span>     </span><span class="hs-comment">-- &#10218;&#961;|&#968;&#10219;&#10746;&#968;  /  &lt;&lt;&#961;|&#968;&gt;&gt;++&#968;</span><span>
</span><a name="line-220"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EmptySetP"><a href="PSL.Syntax.html#EmptySetP"><span class="hs-identifier">EmptySetP</span></a></a><span>             </span><span class="hs-comment">-- {}       /  {}</span><span>
</span><a name="line-221"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SetP"><a href="PSL.Syntax.html#SetP"><span class="hs-identifier">SetP</span></a></a><span> </span><span class="hs-identifier hs-type">&#120143;</span><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span>            </span><span class="hs-comment">-- {&#961;}&#8746;&#968;    /  {&#961;}\/&#968;</span><span>
</span><a name="line-222"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AscrP"><a href="PSL.Syntax.html#AscrP"><span class="hs-identifier">AscrP</span></a></a><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>        </span><span class="hs-comment">-- &#968; : &#964;    /  &#968; : &#964;</span><span>
</span><a name="line-223"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WildP"><a href="PSL.Syntax.html#WildP"><span class="hs-identifier">WildP</span></a></a><span>                 </span><span class="hs-comment">-- _        /  _</span><span>
</span><a name="line-224"></a><span>  </span><span class="hs-comment">-- [&#968;&#8321;;&#8230;;&#968;&#8345;] &#8796; &#968;&#8321; &#8759; &#8943; &#8759; &#968;&#8345; &#8759; []</span><span>
</span><a name="line-225"></a><span>  </span><span class="hs-comment">-- &#10216;&#961;&#8321;.&#968;&#8321;;&#8230;;&#961;&#8345;.&#968;&#8345;&#10217; &#8796; &#10216;&#961;&#8321;.&#968;&#8321;&#10217; &#10746; &#8943; &#10746; &#10216;&#961;&#8345;.&#968;&#8345;&#10217; &#10746; &#10216;&#10217;</span><span>
</span><a name="line-226"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-227"></a><span class="hs-identifier hs-var">makePrettySum</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Pat</span><span>
</span><a name="line-228"></a><span class="hs-identifier hs-var">makePrisms</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Pat</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-comment">--------------------------</span><span>
</span><a name="line-231"></a><span class="hs-comment">-- Primitive Operations --</span><span>
</span><a name="line-232"></a><span class="hs-comment">--------------------------</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-keyword">data</span><span> </span><a name="Op"><a href="PSL.Syntax.html#Op"><span class="hs-identifier">Op</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-235"></a><span>    </span><a name="OrO"><a href="PSL.Syntax.html#OrO"><span class="hs-identifier">OrO</span></a></a><span>               </span><span class="hs-comment">-- e || e</span><span>
</span><a name="line-236"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AndO"><a href="PSL.Syntax.html#AndO"><span class="hs-identifier">AndO</span></a></a><span>              </span><span class="hs-comment">-- e &amp;&amp; e</span><span>
</span><a name="line-237"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NotO"><a href="PSL.Syntax.html#NotO"><span class="hs-identifier">NotO</span></a></a><span>              </span><span class="hs-comment">-- not e</span><span>
</span><a name="line-238"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PlusO"><a href="PSL.Syntax.html#PlusO"><span class="hs-identifier">PlusO</span></a></a><span>             </span><span class="hs-comment">-- e + e</span><span>
</span><a name="line-239"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MinusO"><a href="PSL.Syntax.html#MinusO"><span class="hs-identifier">MinusO</span></a></a><span>            </span><span class="hs-comment">-- e - e</span><span>
</span><a name="line-240"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TimesO"><a href="PSL.Syntax.html#TimesO"><span class="hs-identifier">TimesO</span></a></a><span>            </span><span class="hs-comment">-- e * e</span><span>
</span><a name="line-241"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ExpO"><a href="PSL.Syntax.html#ExpO"><span class="hs-identifier">ExpO</span></a></a><span>              </span><span class="hs-comment">-- exp e</span><span>
</span><a name="line-242"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DivO"><a href="PSL.Syntax.html#DivO"><span class="hs-identifier">DivO</span></a></a><span>              </span><span class="hs-comment">-- e / e</span><span>
</span><a name="line-243"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ModO"><a href="PSL.Syntax.html#ModO"><span class="hs-identifier">ModO</span></a></a><span>              </span><span class="hs-comment">-- e % d</span><span>
</span><a name="line-244"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EqO"><a href="PSL.Syntax.html#EqO"><span class="hs-identifier">EqO</span></a></a><span>               </span><span class="hs-comment">-- e == e</span><span>
</span><a name="line-245"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LTO"><a href="PSL.Syntax.html#LTO"><span class="hs-identifier">LTO</span></a></a><span>               </span><span class="hs-comment">-- e &lt; e</span><span>
</span><a name="line-246"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="GTO"><a href="PSL.Syntax.html#GTO"><span class="hs-identifier">GTO</span></a></a><span>               </span><span class="hs-comment">-- e &gt; e</span><span>
</span><a name="line-247"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LTEO"><a href="PSL.Syntax.html#LTEO"><span class="hs-identifier">LTEO</span></a></a><span>              </span><span class="hs-comment">-- e &lt;= e</span><span>
</span><a name="line-248"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="GTEO"><a href="PSL.Syntax.html#GTEO"><span class="hs-identifier">GTEO</span></a></a><span>              </span><span class="hs-comment">-- e &gt;= e</span><span>
</span><a name="line-249"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CondO"><a href="PSL.Syntax.html#CondO"><span class="hs-identifier">CondO</span></a></a><span>             </span><span class="hs-comment">-- e ? e &gt;&lt; e</span><span>
</span><a name="line-250"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AbsO"><a href="PSL.Syntax.html#AbsO"><span class="hs-identifier">AbsO</span></a></a><span>              </span><span class="hs-comment">-- abs_val e</span><span>
</span><a name="line-251"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SqrtO"><a href="PSL.Syntax.html#SqrtO"><span class="hs-identifier">SqrtO</span></a></a><span>             </span><span class="hs-comment">-- sqrt e</span><span>
</span><a name="line-252"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LogO"><a href="PSL.Syntax.html#LogO"><span class="hs-identifier">LogO</span></a></a><span>              </span><span class="hs-comment">-- log_base_2 e</span><span>
</span><a name="line-253"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NatO"><a href="PSL.Syntax.html#NatO"><span class="hs-identifier">NatO</span></a></a><span> </span><a href="PSL.Syntax.html#IPrecision"><span class="hs-identifier hs-type">IPrecision</span></a><span>   </span><span class="hs-comment">-- nat#n.n</span><span>
</span><a name="line-254"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="IntO"><a href="PSL.Syntax.html#IntO"><span class="hs-identifier">IntO</span></a></a><span> </span><a href="PSL.Syntax.html#IPrecision"><span class="hs-identifier hs-type">IPrecision</span></a><span>   </span><span class="hs-comment">-- int#n.n</span><span>
</span><a name="line-255"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FltO"><a href="PSL.Syntax.html#FltO"><span class="hs-identifier">FltO</span></a></a><span> </span><a href="PSL.Syntax.html#FPrecision"><span class="hs-identifier hs-type">FPrecision</span></a><span>   </span><span class="hs-comment">-- flt#n.n</span><span>
</span><a name="line-256"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CeilO"><a href="PSL.Syntax.html#CeilO"><span class="hs-identifier">CeilO</span></a></a><span> </span><a href="PSL.Syntax.html#IPrecision"><span class="hs-identifier hs-type">IPrecision</span></a><span>  </span><span class="hs-comment">-- ceil#n.n</span><span>
</span><a name="line-257"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-258"></a><span class="hs-identifier hs-var">makePrettySum</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Op</span><span>
</span><a name="line-259"></a><span class="hs-identifier hs-var">makePrisms</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Op</span><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-262"></a><span class="hs-comment">-- Program Terms --</span><span>
</span><a name="line-263"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-comment">-- e &#8712; term &#10868;  &#8230;</span><span>
</span><a name="line-266"></a><span class="hs-keyword">type</span><span> </span><a name="Exp"><a href="PSL.Syntax.html#Exp"><span class="hs-identifier">Exp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Annotated</span><span> </span><span class="hs-identifier hs-type">FullContext</span><span> </span><a href="PSL.Syntax.html#ExpR"><span class="hs-identifier hs-type">ExpR</span></a><span>
</span><a name="line-267"></a><span class="hs-keyword">data</span><span> </span><a name="ExpR"><a href="PSL.Syntax.html#ExpR"><span class="hs-identifier">ExpR</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-268"></a><span>    </span><a name="VarE"><a href="PSL.Syntax.html#VarE"><span class="hs-identifier">VarE</span></a></a><span> </span><a href="PSL.Syntax.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>                                 </span><span class="hs-comment">-- x                       /  x</span><span>
</span><a name="line-269"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BoolE"><a href="PSL.Syntax.html#BoolE"><span class="hs-identifier">BoolE</span></a></a><span> </span><span class="hs-identifier hs-type">&#120121;</span><span>                                  </span><span class="hs-comment">-- b                       /  b</span><span>
</span><a name="line-270"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="StrE"><a href="PSL.Syntax.html#StrE"><span class="hs-identifier">StrE</span></a></a><span> </span><span class="hs-identifier hs-type">&#120138;</span><span>                                   </span><span class="hs-comment">-- s                       /  s</span><span>
</span><a name="line-271"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NatE"><a href="PSL.Syntax.html#NatE"><span class="hs-identifier">NatE</span></a></a><span> </span><a href="PSL.Syntax.html#IPrecision"><span class="hs-identifier hs-type">IPrecision</span></a><span> </span><span class="hs-identifier hs-type">&#8469;</span><span>                        </span><span class="hs-comment">-- n#n.n                   /  n#n.n</span><span>
</span><a name="line-272"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="IntE"><a href="PSL.Syntax.html#IntE"><span class="hs-identifier">IntE</span></a></a><span> </span><a href="PSL.Syntax.html#IPrecision"><span class="hs-identifier hs-type">IPrecision</span></a><span> </span><span class="hs-identifier hs-type">&#8484;</span><span>                        </span><span class="hs-comment">-- i#n.n                   /  i#n.n</span><span>
</span><a name="line-273"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FltE"><a href="PSL.Syntax.html#FltE"><span class="hs-identifier">FltE</span></a></a><span> </span><a href="PSL.Syntax.html#FPrecision"><span class="hs-identifier hs-type">FPrecision</span></a><span> </span><span class="hs-identifier hs-type">&#120123;</span><span>                        </span><span class="hs-comment">-- d#n                     /  d#n</span><span>
</span><a name="line-274"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BulE"><a href="PSL.Syntax.html#BulE"><span class="hs-identifier">BulE</span></a></a><span>                                     </span><span class="hs-comment">-- &#8226;                       /  ()</span><span>
</span><a name="line-275"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="IfE"><a href="PSL.Syntax.html#IfE"><span class="hs-identifier">IfE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                          </span><span class="hs-comment">-- if e then e else e      /  if e then e else e</span><span>
</span><a name="line-276"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MuxIfE"><a href="PSL.Syntax.html#MuxIfE"><span class="hs-identifier">MuxIfE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                       </span><span class="hs-comment">-- mux if e then e else e  /  mux if e then e else e</span><span>
</span><a name="line-277"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LE"><a href="PSL.Syntax.html#LE"><span class="hs-identifier">LE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                                   </span><span class="hs-comment">-- L e                     /  L e</span><span>
</span><a name="line-278"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RE"><a href="PSL.Syntax.html#RE"><span class="hs-identifier">RE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                                   </span><span class="hs-comment">-- R e                     /  R e</span><span>
</span><a name="line-279"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TupE"><a href="PSL.Syntax.html#TupE"><span class="hs-identifier">TupE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                             </span><span class="hs-comment">-- e,e                     /  e,e</span><span>
</span><a name="line-280"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NilE"><a href="PSL.Syntax.html#NilE"><span class="hs-identifier">NilE</span></a></a><span>                                     </span><span class="hs-comment">-- []                      /  []</span><span>
</span><a name="line-281"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ConsE"><a href="PSL.Syntax.html#ConsE"><span class="hs-identifier">ConsE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                            </span><span class="hs-comment">-- e &#8759; e                   /  e :: e</span><span>
</span><a name="line-282"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LetTyE"><a href="PSL.Syntax.html#LetTyE"><span class="hs-identifier">LetTyE</span></a></a><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                           </span><span class="hs-comment">-- let &#968; : &#964; in e          /  let &#968; : &#964; in e</span><span>
</span><a name="line-283"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LetE"><a href="PSL.Syntax.html#LetE"><span class="hs-identifier">LetE</span></a></a><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                         </span><span class="hs-comment">-- let &#968; = e in e          /  let &#968; = e in e</span><span>
</span><a name="line-284"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CaseE"><a href="PSL.Syntax.html#CaseE"><span class="hs-identifier">CaseE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Pat</span><span> </span><span class="hs-operator hs-type">&#8743;</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>                </span><span class="hs-comment">-- case e {&#968;&#8594;e;&#8230;;&#968;&#8594;e}      /  case e {&#968;-&gt;e;&#8230;;&#968;-&gt;e}</span><span>
</span><a name="line-285"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MuxCaseE"><a href="PSL.Syntax.html#MuxCaseE"><span class="hs-identifier">MuxCaseE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Pat</span><span> </span><span class="hs-operator hs-type">&#8743;</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>             </span><span class="hs-comment">-- mux case e {&#968;&#8594;e;&#8230;;&#968;&#8594;e}  /  mux case e {&#968;-&gt;e;&#8230;;&#968;-&gt;e}</span><span>
</span><a name="line-286"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LamE"><a href="PSL.Syntax.html#LamE"><span class="hs-identifier">LamE</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119874;</span><span> </span><a href="PSL.Syntax.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                 </span><span class="hs-comment">-- &#955; [x] &#968;&#8230;&#968; &#8594; e           /  fun [x] &#968;&#8230;&#968; &#8594; e</span><span>
</span><a name="line-287"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AppE"><a href="PSL.Syntax.html#AppE"><span class="hs-identifier">AppE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                             </span><span class="hs-comment">-- e e                     /  e e</span><span>
</span><a name="line-288"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TLamE"><a href="PSL.Syntax.html#TLamE"><span class="hs-identifier">TLamE</span></a></a><span> </span><a href="PSL.Syntax.html#TVar"><span class="hs-identifier hs-type">TVar</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                           </span><span class="hs-comment">-- &#923; &#945; &#8594; e                 /  abs &#945; &#8594; e</span><span>
</span><a name="line-289"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TAppE"><a href="PSL.Syntax.html#TAppE"><span class="hs-identifier">TAppE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                           </span><span class="hs-comment">-- e@&#964;                     /  e@&#964;</span><span>
</span><a name="line-290"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ParE"><a href="PSL.Syntax.html#ParE"><span class="hs-identifier">ParE</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                     </span><span class="hs-comment">-- par {P} e               /  par {P} e</span><span>
</span><a name="line-291"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ShareE"><a href="PSL.Syntax.html#ShareE"><span class="hs-identifier">ShareE</span></a></a><span> </span><a href="PSL.Syntax.html#Prot"><span class="hs-identifier hs-type">Prot</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>  </span><span class="hs-comment">-- share{&#966;:P&#8594;P} e          /  share{&#966;:P-&gt;P} e</span><span>
</span><a name="line-292"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AccessE"><a href="PSL.Syntax.html#AccessE"><span class="hs-identifier">AccessE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span>                      </span><span class="hs-comment">-- e@&#961;                     /  e@&#961;</span><span>
</span><a name="line-293"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BundleE"><a href="PSL.Syntax.html#BundleE"><span class="hs-identifier">BundleE</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PrinExp</span><span> </span><span class="hs-operator hs-type">&#8743;</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>              </span><span class="hs-comment">-- &#10218;&#961;|e;&#8230;;&#961;|e&#10219;             /  &lt;&lt;&#961;|e;&#8230;;&#961;|e&gt;&gt;</span><span>
</span><a name="line-294"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BundleUnionE"><a href="PSL.Syntax.html#BundleUnionE"><span class="hs-identifier">BundleUnionE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                     </span><span class="hs-comment">-- e&#10746;e                     /  e++e</span><span>
</span><a name="line-295"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RevealE"><a href="PSL.Syntax.html#RevealE"><span class="hs-identifier">RevealE</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                  </span><span class="hs-comment">-- reveal {P} e            /  reveal{P} e</span><span>
</span><a name="line-296"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SendE"><a href="PSL.Syntax.html#SendE"><span class="hs-identifier">SendE</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>        </span><span class="hs-comment">-- send {P&#8594;P} e            /  send{P-&gt;P} e</span><span>
</span><a name="line-297"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AscrE"><a href="PSL.Syntax.html#AscrE"><span class="hs-identifier">AscrE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                           </span><span class="hs-comment">-- e:&#964;                     /  e:&#964;</span><span>
</span><a name="line-298"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ReadE"><a href="PSL.Syntax.html#ReadE"><span class="hs-identifier">ReadE</span></a></a><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                           </span><span class="hs-comment">-- read &#964; e                /  read &#964; e</span><span>
</span><a name="line-299"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WriteE"><a href="PSL.Syntax.html#WriteE"><span class="hs-identifier">WriteE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                           </span><span class="hs-comment">-- write e                 /  write e</span><span>
</span><a name="line-300"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RandE"><a href="PSL.Syntax.html#RandE"><span class="hs-identifier">RandE</span></a></a><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                               </span><span class="hs-comment">-- rand &#964;                  /  rand &#964;</span><span>
</span><a name="line-301"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RandRangeE"><a href="PSL.Syntax.html#RandRangeE"><span class="hs-identifier">RandRangeE</span></a></a><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                      </span><span class="hs-comment">-- rand-range &#964; e          /  rand-range &#964; e</span><span>
</span><a name="line-302"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InferE"><a href="PSL.Syntax.html#InferE"><span class="hs-identifier">InferE</span></a></a><span>                                   </span><span class="hs-comment">-- _                       /  _</span><span>
</span><a name="line-303"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="HoleE"><a href="PSL.Syntax.html#HoleE"><span class="hs-identifier">HoleE</span></a></a><span>                                    </span><span class="hs-comment">-- &#8263;                       /  ??</span><span>
</span><a name="line-304"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PrimE"><a href="PSL.Syntax.html#PrimE"><span class="hs-identifier">PrimE</span></a></a><span> </span><a href="PSL.Syntax.html#Op"><span class="hs-identifier hs-type">Op</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span class="hs-special">)</span><span>                         </span><span class="hs-comment">-- prim[&#8857;](e,&#8230;,e)          /  prim[&#8857;](e,&#8230;,e)</span><span>
</span><a name="line-305"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TraceE"><a href="PSL.Syntax.html#TraceE"><span class="hs-identifier">TraceE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                           </span><span class="hs-comment">-- trace e in e            /  trace e in e</span><span>
</span><a name="line-306"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SetE"><a href="PSL.Syntax.html#SetE"><span class="hs-identifier">SetE</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span>                         </span><span class="hs-comment">-- {P}                     /  {P}</span><span>
</span><a name="line-307"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RefE"><a href="PSL.Syntax.html#RefE"><span class="hs-identifier">RefE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                                 </span><span class="hs-comment">-- ref e                   /  ref e</span><span>
</span><a name="line-308"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RefReadE"><a href="PSL.Syntax.html#RefReadE"><span class="hs-identifier">RefReadE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                             </span><span class="hs-comment">-- !e                      /  !e</span><span>
</span><a name="line-309"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RefWriteE"><a href="PSL.Syntax.html#RefWriteE"><span class="hs-identifier">RefWriteE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                        </span><span class="hs-comment">-- e &#8788; e                   /  e := e</span><span>
</span><a name="line-310"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ArrayE"><a href="PSL.Syntax.html#ArrayE"><span class="hs-identifier">ArrayE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                           </span><span class="hs-comment">-- array[e] e              /  array[e] e</span><span>
</span><a name="line-311"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ArrayReadE"><a href="PSL.Syntax.html#ArrayReadE"><span class="hs-identifier">ArrayReadE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                       </span><span class="hs-comment">-- e.e                     /  e.e</span><span>
</span><a name="line-312"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ArrayWriteE"><a href="PSL.Syntax.html#ArrayWriteE"><span class="hs-identifier">ArrayWriteE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                      </span><span class="hs-comment">-- e &#8592; e                   /  e &lt;- e</span><span>
</span><a name="line-313"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SizeE"><a href="PSL.Syntax.html#SizeE"><span class="hs-identifier">SizeE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                                </span><span class="hs-comment">-- size e                  /  size e</span><span>
</span><a name="line-314"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DefaultE"><a href="PSL.Syntax.html#DefaultE"><span class="hs-identifier">DefaultE</span></a></a><span>                                 </span><span class="hs-comment">-- &#8869;                       /  _|_</span><span>
</span><a name="line-315"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ProcE"><a href="PSL.Syntax.html#ProcE"><span class="hs-identifier">ProcE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                                </span><span class="hs-comment">-- proc e                  /  proc e</span><span>
</span><a name="line-316"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ReturnE"><a href="PSL.Syntax.html#ReturnE"><span class="hs-identifier">ReturnE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                              </span><span class="hs-comment">-- return e                /  return e</span><span>
</span><a name="line-317"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NizkWitnessE"><a href="PSL.Syntax.html#NizkWitnessE"><span class="hs-identifier">NizkWitnessE</span></a></a><span> </span><a href="PSL.Syntax.html#Prot"><span class="hs-identifier hs-type">Prot</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>        </span><span class="hs-comment">-- nizk-witness{&#966;:P} e     /  nizk-witness{&#966;:P} e</span><span>
</span><a name="line-318"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NizkCommitE"><a href="PSL.Syntax.html#NizkCommitE"><span class="hs-identifier">NizkCommitE</span></a></a><span> </span><a href="PSL.Syntax.html#Prot"><span class="hs-identifier hs-type">Prot</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>         </span><span class="hs-comment">-- nizk-commit{&#966;:P} e      /  nizk-commit{&#966;:P} e</span><span>
</span><a name="line-319"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="StringConcatE"><a href="PSL.Syntax.html#StringConcatE"><span class="hs-identifier">StringConcatE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                    </span><span class="hs-comment">-- e &#10747; e                   /  e +++ e</span><span>
</span><a name="line-320"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ToStringE"><a href="PSL.Syntax.html#ToStringE"><span class="hs-identifier">ToStringE</span></a></a><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                            </span><span class="hs-comment">-- str e                   /  str e</span><span>
</span><a name="line-321"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SignE"><a href="PSL.Syntax.html#SignE"><span class="hs-identifier">SignE</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                    </span><span class="hs-comment">-- sign {P} e              /  sign {P} e</span><span>
</span><a name="line-322"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="UnsignE"><a href="PSL.Syntax.html#UnsignE"><span class="hs-identifier">UnsignE</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                  </span><span class="hs-comment">-- unsign {P} e            /  unsign {P} e</span><span>
</span><a name="line-323"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="IsSignedE"><a href="PSL.Syntax.html#IsSignedE"><span class="hs-identifier">IsSignedE</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>                </span><span class="hs-comment">-- is-signed {P} e         /  is-signed {P} e</span><span>
</span><a name="line-324"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-325"></a><span>  </span><span class="hs-comment">-- [e&#8321;;&#8230;;e&#8345;] &#8796; e&#8321; &#8759; &#8943; &#8759; e&#8345; &#8759; []</span><span>
</span><a name="line-326"></a><span class="hs-identifier hs-var">makePrettySum</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">ExpR</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-identifier">buildLambda</span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-identifier hs-type">FullContext</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><a href="PSL.Syntax.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>
</span><a name="line-329"></a><a name="buildLambda"><a href="PSL.Syntax.html#buildLambda"><span class="hs-identifier">buildLambda</span></a></a><span> </span><a name="local-6989586621679083092"><a href="#local-6989586621679083092"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679083093"><a href="#local-6989586621679083093"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679083094"><a href="#local-6989586621679083094"><span class="hs-identifier">&#968;s</span></a></a><span> </span><a name="local-6989586621679083095"><a href="#local-6989586621679083095"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-330"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679083094"><span class="hs-identifier hs-var">&#968;s</span></a><span> </span><span class="hs-operator hs-var">&#8801;</span><span> </span><span class="hs-identifier hs-var">Nil</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679083095"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-331"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Annotated</span><span> </span><a href="#local-6989586621679083092"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="PSL.Syntax.html#LamE"><span class="hs-identifier hs-var">LamE</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Some</span><span> </span><a href="#local-6989586621679083093"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679083094"><span class="hs-identifier hs-var">&#968;s</span></a><span> </span><a href="#local-6989586621679083095"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-332"></a><span>
</span><a name="line-333"></a><span class="hs-identifier">buildUnfixedLambda</span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-identifier hs-type">FullContext</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><a href="PSL.Syntax.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">&#8594;</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>
</span><a name="line-334"></a><a name="buildUnfixedLambda"><a href="PSL.Syntax.html#buildUnfixedLambda"><span class="hs-identifier">buildUnfixedLambda</span></a></a><span> </span><a name="local-6989586621679083096"><a href="#local-6989586621679083096"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679083097"><a href="#local-6989586621679083097"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679083098"><a href="#local-6989586621679083098"><span class="hs-identifier">&#968;s</span></a></a><span> </span><a name="local-6989586621679083099"><a href="#local-6989586621679083099"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-335"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679083098"><span class="hs-identifier hs-var">&#968;s</span></a><span> </span><span class="hs-operator hs-var">&#8801;</span><span> </span><span class="hs-identifier hs-var">Nil</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679083099"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-336"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Annotated</span><span> </span><a href="#local-6989586621679083096"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="PSL.Syntax.html#LamE"><span class="hs-identifier hs-var">LamE</span></a><span> </span><span class="hs-identifier hs-var">None</span><span> </span><span class="hs-special">(</span><a href="PSL.Syntax.html#VarP"><span class="hs-identifier hs-var">VarP</span></a><span> </span><a href="#local-6989586621679083097"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">:&amp;</span><span> </span><a href="#local-6989586621679083098"><span class="hs-identifier hs-var">&#968;s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679083099"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-339"></a><span class="hs-comment">-- Top-level --</span><span>
</span><a name="line-340"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">-- tl &#8712; top-level &#10868;  &#8230;</span><span>
</span><a name="line-343"></a><span class="hs-keyword">type</span><span> </span><a name="TL"><a href="PSL.Syntax.html#TL"><span class="hs-identifier">TL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Annotated</span><span> </span><span class="hs-identifier hs-type">FullContext</span><span> </span><a href="PSL.Syntax.html#TLR"><span class="hs-identifier hs-type">TLR</span></a><span>
</span><a name="line-344"></a><span class="hs-keyword">data</span><span> </span><a name="TLR"><a href="PSL.Syntax.html#TLR"><span class="hs-identifier">TLR</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-345"></a><span>    </span><a name="DeclTL"><a href="PSL.Syntax.html#DeclTL"><span class="hs-identifier">DeclTL</span></a></a><span> </span><span class="hs-identifier hs-type">&#120121;</span><span> </span><a href="PSL.Syntax.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>               </span><span class="hs-comment">-- def [sec] x : &#964;            /  def [sec] x : &#964;</span><span>
</span><a name="line-346"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DefnTL"><a href="PSL.Syntax.html#DefnTL"><span class="hs-identifier">DefnTL</span></a></a><span> </span><span class="hs-identifier hs-type">&#120121;</span><span> </span><a href="PSL.Syntax.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span class="hs-special">)</span><span> </span><a href="PSL.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>        </span><span class="hs-comment">-- def [sec] x &#968;&#8321; &#8230; = e       /  def [sec] x  &#968;&#8321; &#8230; = e</span><span>
</span><a name="line-347"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PrinTL"><a href="PSL.Syntax.html#PrinTL"><span class="hs-identifier">PrinTL</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinDecl"><span class="hs-identifier hs-type">PrinDecl</span></a><span class="hs-special">)</span><span>             </span><span class="hs-comment">-- principal &#961; &#8230;              /  principal &#961; &#8230;</span><span>
</span><a name="line-348"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PrimTL"><a href="PSL.Syntax.html#PrimTL"><span class="hs-identifier">PrimTL</span></a></a><span> </span><a href="PSL.Syntax.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><a href="PSL.Syntax.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                 </span><span class="hs-comment">-- primitive x : &#964;            /  primitive x : &#964;</span><span>
</span><a name="line-349"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ImportTL"><a href="PSL.Syntax.html#ImportTL"><span class="hs-identifier">ImportTL</span></a></a><span> </span><span class="hs-identifier hs-type">&#120138;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#120138;</span><span> </span><span class="hs-operator hs-type">&#8743;</span><span> </span><span class="hs-identifier hs-type">&#119871;</span><span> </span><a href="PSL.Syntax.html#PrinExp"><span class="hs-identifier hs-type">PrinExp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- import s with [x = {P}] &#8230;  /  import s with [x = {P}] &#8230;</span><span>
</span><a name="line-350"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="VirtualPartyTL"><a href="PSL.Syntax.html#VirtualPartyTL"><span class="hs-identifier">VirtualPartyTL</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">&#119871;</span><span> </span><span class="hs-identifier hs-type">&#120138;</span><span class="hs-special">)</span><span>            </span><span class="hs-comment">-- virtual party x            /  virtual party x</span><span>
</span><a name="line-351"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-352"></a><span class="hs-identifier hs-var">makePrettySum</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">TLR</span><span>
</span><a name="line-353"></a></pre></body></html>