principal A
principal B
principal C
principal D
principal E

trust A,B,C,D,E -- TODO say things like "A trusts B semi-honest, but B trusts A malicious"

security A â«« B --
security C â«« D -- TODO relax to say some number of corruptions

-- TODO: look at Fabric

-- delegate thing as a function

-- tracks who participates, also checks C,D
def compareInline : â„¤{A} â†’ â„¤{B} â†’ MPC{A,B âª« C,D} ğ”¹[yao:E,F]
def compareInline = Î» a â†’ Î» b â†’ mpc{yao:C,D} circuit a < b [yao:E,F]

-- just tracks who participates
def compareCIR : â„¤{A} â†’ â„¤{B} â†’ CIR{bool:A,B} ğ”¹
def compareCIR = Î» a â†’ Î» b â†’ circuit a < b

def compareMPC : â„¤{A} â†’ â„¤{B} â†’ MPC{A,B âª« C,D} ğ”¹[yao:E,F]
def compareMPC = Î» a â†’ Î» b â†’
  do c â† mpc{yao:C,D} compareCIR a b [yao:E,F];
  return c

def send : â„¤{A} â†’ MPC{Aâª«} ğ”¹{B}
def send = Î» a â†’
  do b â† mpc{none:} circuit a {B};
  return b

def send : â„¤{A} â†’ MPC{Aâª«} ğ”¹{B}
def send = Î» a â†’
  return a {B}

def distribute : â„¤{A} â†’ MPC{Aâª«} â„¤[yao:B,C]
def distribute = Î» a â†’
  do bc â† mpc{none:} circuit a {B,C};
  return bc

def combine : â„¤[bgw:A,B] â†’ MPC{Aâª«} â„¤{C}
def combine = Î» ab â†’
  do c â† mpc{none:} circuit ab {C};
  return c

def split : â„¤{A} â†’ MPC{Aâª«} â„¤[yao:B,C] Ã— â„¤[bgw:C,D]
def split = Î» a â†’
  do bc,cd â† mpc{none:} circuit a [yao:B,C] , a [bgw:C,D];
  return bc,cd

-- def split2 : â„¤{A} â†’ MPC{A} â„¤{yao:B,C|bgw:C,D}
-- def split2 = Î» a â†’
--   c â† mpc circuit a {B,C|C,D};
--   return c;

def swap : â„¤[yao:A,B] â†’ â„¤[bgw:A,C] â†’ MPC{A,B,Câª«} â„¤[bgw:A,C] Ã— â„¤[yao:A,B]
def swap = Î» ab â†’ Î» ac â†’
  do ra,rb â† mpc{none:} circuit ab [bgw:A,C] , ac [yao:A,B];
  return ra,rb

def compareConstInline : â„¤{B,C} â†’ â„¤{A} â†’ MPC{A âª« B,C} ğ”¹{D}
def compareConstInline = Î» x â†’ Î» a â†’
  do c â† mpc{gmw:B,C} circuit x < a {D};
  retun c

def compareConstCIR : â„¤ â†’ â„¤{A} â†’ CIR{bool:A} ğ”¹{D}
def compareConstCIR = Î» x â†’ Î» a â†’ circuit x < a {D}

def compareConstMPC : â„¤ â†’ â„¤{A} â†’ MPC{A âª« B,C} ğ”¹{D}
def compareConstMPC = Î» x â†’ Î» a â†’
  do c â† mpc{gmw:B,C} compareConstCIR a b {D};
  return c
