principal A
principal B
principal C
principal D
principal E

trust A,B,C,D,E -- TODO say things like "A trusts B semi-honest, but B trusts A malicious"

security A â«« B --
security C â«« D -- TODO relax to say some number of corruptions

-- TODO: look at Fabric

-- delegate thing as a function

-- tracks who participates, also checks C,D
def compareInline : â„¤{sec:A} â†’ â„¤{sec:B} â†’ MPC{A,B âª« C,D} ğ”¹{ashare:E,F}
def compareInline = Î» a â†’ Î» b â†’ mpc{yao:C,D} share{ashare:E,F} circuit a < b

-- just tracks who participates
def compareCIR : â„¤{sec:A} â†’ â„¤{sec:B} â†’ ğ”¹{bcir:A,B}
def compareCIR = Î» a â†’ Î» b â†’ circuit a < b

def compareMPC : â„¤{sec:A} â†’ â„¤{sec:B} â†’ MPC{A,B âª« C,D} ğ”¹{ashare:E,F}
def compareMPC = Î» a â†’ Î» b â†’
  do c â† mpc{yao:C,D} share{ashare:E,F} compareCIR a b;
  return c

def send : â„¤{sec:A} â†’ MPC{Aâª«} ğ”¹{sec:B}
def send = Î» a â†’
  do b â† mpc{none:} share{B} circuit a;
  return b

def distribute : â„¤{sec:A} â†’ MPC{Aâª«} â„¤{sshare:B,C}
def distribute = Î» a â†’
  do bc â† mpc{none:} share{sshare:B,C} circuit a;
  return bc

def combine : â„¤{sshare:A,B} â†’ MPC{Aâª«} â„¤{sec:C}
def combine = Î» ab â†’
  do c â† mpc{none:} share{C} circuit ab;
  return c

def split : â„¤{sec:A} â†’ MPC{Aâª«} â„¤{ashare:B,C} Ã— â„¤{ashare:C,D}
def split = Î» a â†’
  let aa = circuit a in
  do bc,cd â† mpc{none:} (share{ashare:B,C} aa) , (share{ashare:C,D} aa);
  return bc,cd

-- def split2 : â„¤{A} â†’ MPC{A} â„¤{yao:B,C|bgw:C,D}
-- def split2 = Î» a â†’
--   c â† mpc circuit a {B,C|C,D};
--   return c;

def swap : â„¤{ashare:A,B} â†’ â„¤{ashare:A,C} â†’ MPC{A,B,Câª«} â„¤{ashare:A,C} Ã— â„¤{ashare:A,B}
def swap = Î» ab â†’ Î» ac â†’
  do ra,rb â† mpc{none:} (share{ashare:A,C} circuit ab) , (share{ashare:A,B} circuit ac);
  return ra,rb

def compareConstInline : â„¤ â†’ â„¤{sec:A} â†’ MPC{A âª« B,C} ğ”¹{sec:D}
def compareConstInline = Î» x â†’ Î» a â†’
  do c â† mpc{gmw:B,C} share{D} circuit x < a;
  retun c

def compareConstCIR : â„¤ â†’ â„¤{sec:A} â†’ ğ”¹{bcir:A}
def compareConstCIR = Î» x â†’ Î» a â†’ circuit x < a

def compareConstMPC : â„¤ â†’ â„¤{sec:A} â†’ MPC{A âª« B,C} ğ”¹{sec:D}
def compareConstMPC = Î» x â†’ Î» a â†’
  do c â† mpc{gmw:B,C} share{D} compareConstCIR a b;
  return c
